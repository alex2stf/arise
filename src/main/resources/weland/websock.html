<html>
<head>
    <meta charset="utf-8"/>
</head>
AICI
<!--<video id="vid_container" cwidth="320" height="240" controls="controls" autoplay="autoplay">-->
    <!--<source src="VID_0_20181217_160625.mp4" type="video/mp4">-->
<!--</video>-->

<!--<video id="vid_container" src="rtsp://127.0.0.1:8086/vid">-->
    <!--Your browser does not support the VIDEO tag and/or RTP streams.-->
<!--</video>-->

<!--<object type="application/x-vlc-plugin" data="rtsp://192.168.1.0/archive/258136f02a9d1c1" width="400" height="300" id="video1">-->
    <!--<param name="movie" value="rtsp://192.168.1.0/archive/258136f02a9d1c1"/>-->
    <!--<embed type="application/x-vlc-plugin" name="video1"-->
           <!--autoplay="no" loop="no" width="400" height="300"-->
           <!--target="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov" />-->
    <!--<a href="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov">Download Video1</a>-->
<!--</object>-->



<!--<video autoplay id="my-video" class="video-js" controls preload="auto" width="640" height="360"-->
       <!--poster="https://ubcdn.co/static/images/enterprise/overview/unifi-video-overview-2x.png" data-refreshUI="{}">-->
    <!--<source src="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov" type='rtmp/mp4'>-->
    <!--<p class="vjs-no-js">-->
        <!--To view this video please enable JavaScript, and consider upgrading to a web browser that-->
        <!--<a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>-->
    <!--</p>-->
<!--</video>-->

<!--<embed-->

        <!--id="vlc"-->

        <!--name="vlc"-->

        <!--type="application/x-vlc-plugin"-->

        <!--pluginspage="http://www.videolan.org" version="VideoLAN.VLCPlugin.2"-->

        <!--width=440 height=280-->

        <!--autoplay="yes"-->

        <!--enablejavascript="true"-->

        <!--target="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov"-->

        <!--align=center />-->

<!--<OBJECT classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921"-->
        <!--codebase="http://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab"-->
        <!--width="640" height="480" id="vlc" events="True">-->
    <!--<param name="Src" value="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov" />-->
    <!--<param name="ShowDisplay" value="True" />-->
    <!--<param name="AutoLoop" value="False" />-->
    <!--<param name="AutoPlay" value="True" />-->
    <!--<embed id="vlcEmb"  type="application/x-google-vlc-plugin" version="VideoLAN.VLCPlugin.2" autoplay="yes" loop="no" width="640" height="480"-->
           <!--target="rtsp://184.72.239.149/vod/mp4:BigBuckBunny_175k.mov" ></embed>-->
<!--</OBJECT>-->
<div id="player" class="player"></div>
<img src="/img-tst"/>


Client requested:

<pre>
    {{request_debug}}
</pre>

<div id="log_area">

</div>

<script>

    // var ws = new WebSocket("ws://localhost:7004");
    // var url = "{{ws_host}}://localhost:{{port}}";
    var url = "{{ws_host}}://localhost:8778";
    // var url = "{{ws_host}}://localhost:8221";
    // var url = "ws://localhost:7003";
    var msgs = {{test_messages}};
    var tmsg = {};
    var totalSize = 0;
    var tps = 0;

    for (var i in msgs){
        tmsg[i] = {
            rsp: msgs[i],
            pas: 0
        }
        totalSize++;
    }

    append("connect to " + url);

    var ws = new WebSocket(url);

    ws.onopen = function() {
        append('connection opened, start test');
        // Web Socket is connected, send data using send()
        for (var i in tmsg){
            append('sending [' + i + ']');
            ws.send(i);
        }
    };

    ws.onmessage = function (evt) {
        var received_msg = evt.data;

        for (var i in tmsg){
            if(tmsg[i].rsp == received_msg){
                tmsg[i].pas = 1;
            }
        }


        tps = 0;
        for (var i in tmsg){
            if(tmsg[i].pas == 1){
                tps++;
            }
            else if(tmsg[i].pas > 0){
                append("BIG BIG FUCK AT " + i)
                throw new Error("BIG FUCK " + i)
            }
        }

        append('received [' + received_msg + ']  (' + tps + " / " + totalSize + ')');
        if (tps == totalSize){
            ws.close()
        }
    };

    ws.onclose = function() {

        // websocket is closed.
        append("Connection is closed, test finished for "+ tps + " / " + totalSize + " cases");
    };

    function append(text) {
        document.getElementById('log_area').innerHTML += '<div>' + text+'</div>';
    }

</script>
</html>
